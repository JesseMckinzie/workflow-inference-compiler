# This is based on the excellent gromacs CWL tutorial http://mmb.irbbarcelona.org/webdev/slim/biobb/public/availability/tutorials/cwl
# The `in` tags are superfluous, but retained for now to simplify implementation.
# Limit nsteps to 1000 for demo / development.
steps:
  - setup.yml:  # Auto-generated subworkflow!
# Minimization
  - min.yml:
# NVT equil
  - nvt.yml:
# NPT equil
  - npt.yml:
# Production
  - prod.yml:
# Trajectory Analysis
  - gmx_rms:
      in:
        config: '{"selection": "Backbone"}'
        output_xvg_path: 'rmsd_first.xvg'
  - gmx_rms:
      in:
        config: '{"selection": "Backbone"}'
        output_xvg_path: 'rmsd_exp.xvg'
        input_structure_path: '$min.tpr'
  - gmx_rgyr:
      in:
        config: '{"selection": "Backbone"}'
        input_structure_path: '$min.tpr'
  - gmx_image:
      in:
        config: '{"center_selection":"Protein","output_selection":"Protein","pbc":"mol"}'
        input_top_path: '$prod.tpr'
  - gmx_trjconv_str:
      in:
        config: '{"selection": "Protein"}'
        input_top_path: '$prod.tpr'
        input_structure_path: '$prod.gro'
